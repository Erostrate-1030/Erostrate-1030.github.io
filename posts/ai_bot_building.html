<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="pragma" content="no-cache">
  <meta http-equiv="cache-control" content="no-cache">
  <meta http-equiv="expires" content="0">
  
  <title>å”‰é…± æ­å»ºæ—¥å¿— | EROSTRATE&#39;S LIBRARY</title>
  <meta name="author" content="Erostrate">
  
  <meta name="description" content="ä»¿ç”Ÿé•¿æ¯›è±¡æœºå™¨äººä¼šä¸ä¼šåƒäººç±»ä¸€æ ·æœ‰è¯¸å¤šçƒ¦æ¼ã€‚">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta property="og:title" content="å”‰é…± æ­å»ºæ—¥å¿—"/>
  <meta property="og:site_name" content="EROSTRATE&#39;S LIBRARY"/>

  
    <meta property="og:image" content=""/>
  

  
    <link rel="alternative" href="/atom.xml" title="EROSTRATE&#39;S LIBRARY" type="application/atom+xml">
  
  
    <link href="/favicon.ico" rel="icon">
  
  
  <link rel="stylesheet" href="/css/bootstrap.min.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/font-awesome.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/responsive.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/highlight.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/google-fonts.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

  <script src="/js/jquery-2.0.3.min.js"></script>

  <!-- analytics -->
  



<meta name="generator" content="Hexo 6.2.0"></head>

 <body>  
  <nav id="main-nav" class="navbar navbar-inverse navbar-fixed-top" role="navigation">
    <div class="container">
      <button type="button" class="navbar-header navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
		<span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
	  <a class="navbar-brand" href="/">EROSTRATE&#39;S LIBRARY</a>
      <div class="collapse navbar-collapse nav-menu">
		<ul class="nav navbar-nav">
		  
		  <li>
			<a href="/about" title="">
			  <i class="fa fa-user"></i>About
			</a>
		  </li>
		  
		  <li>
			<a href="/archives" title="">
			  <i class="fa fa-archive"></i>Archives
			</a>
		  </li>
		  
		  <li>
			<a href="/categories" title="">
			  <i class="fa fa-folder"></i>Categories
			</a>
		  </li>
		  
		  <li>
			<a href="/tags" title="">
			  <i class="fa fa-tags"></i>Tags
			</a>
		  </li>
		  
		  <li>
			<a href="/atom.xml" title="">
			  <i class="fa fa-rss"></i>RSS
			</a>
		  </li>
		  
		</ul>
      </div>
    </div> <!-- container -->
</nav>
<div class="clearfix"></div>

  <div class="container">
  	<div class="content">
    	 


	
		<div class="page-header">
			<h1> å”‰é…± æ­å»ºæ—¥å¿—</h1>
		</div>
	



<div class="row post">
	<!-- cols -->
	
	<div id="top_meta"></div>
	<div class="col-md-9">
	

	<!-- content -->
	<div class="mypage">		
	  		

	  <p>ä»¿ç”Ÿé•¿æ¯›è±¡æœºå™¨äººä¼šä¸ä¼šåƒäººç±»ä¸€æ ·æœ‰è¯¸å¤šçƒ¦æ¼ã€‚</p>
<span id="more"></span>

<blockquote>
<p>ğŸ‘¾ï¼šçªç„¶æƒ³åˆ°äº†ä¸€ä¸ªç»å¦™çš„botæƒ³æ³•<br>    ï¼šéšæœºäº§å‡ºâ€œå”‰ï¼Œâ€¦â€è¯­å¥<br>    ï¼šæ¯å¤©å”‰ä¸ª2-3æ¡<br>    ï¼šbotåå«äººç±»<br>ğŸ°ï¼šå”‰  æˆ‘cpåšçˆ±å¤ªå¤š</p>
</blockquote>
<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å¦‚ä¸Šæ‰€è¿°ï¼ŒåŠå¤œç¡è§‰ä¹‹å‰çªç„¶æƒ³åˆ°å¯ä»¥è¿™æ ·åšã€‚<del>å€Ÿè¿™ä¸ªBotï¼Œæˆ‘ä»¬ä¸€èµ·æ¥æ€è€ƒï¼Œ(é)ä»¿ç”Ÿé•¿æ¯›è±¡æœºå™¨äººä¼šä¸ä¼šåƒäººç±»ä¸€æ ·æœ‰è¯¸å¤šçƒ¦æ¼ã€‚</del></p>
<p>è¿™ä¸ªæœºå™¨äººåº”è¯¥ä¼šéšç€æˆ‘è„‘æ´çš„æ‰©å¤§æŒç»­æ›´æ–°ï¼Œæ‰€ä»¥åœ¨åˆ›å»ºè¿™ç¯‡æ–‡ç« çš„åŒæ—¶ï¼Œæˆ‘åˆ›å»ºäº†ç›¸åº”çš„æ›´æ–°æ—¥å¿—ã€‚å…¶ä»–åç»­åŠŸèƒ½ï¼ˆ<del>ä»¥åŠç”»é¥¼</del>ï¼‰ä¼šæ›´æ–°åœ¨æ›´æ–°æ—¥å¿—ä¸­ã€‚</p>
<p>æœ¬ç¯‡æ–‡ç« ä¸­ï¼Œæ‰€æœ‰èµ„æ–™çš„å‚è€ƒæ¥æºéƒ½è¿›è¡Œäº†æ ‡æ³¨ï¼Œå¦‚æœæœ‰æ­å»ºéœ€è¦çš„æœ‹å‹å¯è‡ªè¡ŒæŸ¥é˜…ã€‚</p>
<p><strong>ç›®å‰åŸºæœ¬æ­å»ºéœ€æ±‚</strong>ï¼š</p>
<ul>
<li>æ¯å¤©å®šæ—¶äº§å‡ºéšæœºè¯­å¥ï¼ˆâ€œå”‰ï¼Œâ€ + ä»»æ„å†…å®¹ï¼‰</li>
<li>æ ¹æ®ç”¨æˆ·æŠ•ç¨¿ï¼Œè¯­æ–™åº“å¯æ›´æ–°</li>
</ul>
<hr>
<h2 id="æ­å»º"><a href="#æ­å»º" class="headerlink" title="æ­å»º"></a>æ­å»º</h2><h3 id="ğŸ”—-Setting-up-a-Mastodon-Bot"><a href="#ğŸ”—-Setting-up-a-Mastodon-Bot" class="headerlink" title="ğŸ”— Setting up a Mastodon Bot"></a><a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=pY4b18JGCKE&list=PLRqwX-V7Uu6byiVX7_Z1rclitVhMBmNFQ&index=2">ğŸ”—</a> Setting up a Mastodon Bot</h3><h4 id="bot-js"><a href="#bot-js" class="headerlink" title="bot.js"></a><code>bot.js</code></h4><p>å¹¶ä¸æ˜¯æ‰€æœ‰çš„å®ä¾‹éƒ½æ¬¢è¿æœºå™¨äººçš„æ³¨å†Œã€‚è¿™é‡Œæˆ‘é€‰æ‹©äº† <a target="_blank" rel="noopener" href="https://wxw.moe/">å‘œå‘œç«™</a> è¿™ä¸ªå®ä¾‹æ­å»ºæˆ‘çš„æœºå™¨äººã€‚ç¬¬ä¸€æ­¥æˆ‘ä»¬éœ€è¦ä¸ºæœºå™¨äººæ³¨å†Œä¸€ä¸ªè´¦å·ï¼Œåœ¨æ³¨å†Œå¸å·ä¹‹åï¼Œå®ä¾‹ç®¡ç†å‘˜éœ€è¦ä¸€å®šæ—¶é—´å®¡æ ¸æˆ‘ä»¬çš„è¯·æ±‚ã€‚</p>
<p>æ³¨å†Œä¹‹åå¡«å†™è‡ªå·±çš„ä¸ªäººèµ„æ–™ï¼Œåœ¨èµ„æ–™é¡µé¢<strong>å¿…é¡»</strong>å‹¾é€‰ <code>This is a bot accout</code> é€‰é¡¹ã€‚</p>
<p>åœ¨è´¦å·ä¸»é¡µé¢ï¼Œæ‰¾åˆ° <code>Edit profile - Development - New application</code> ã€‚ä¿å­˜è®¾ç½®åï¼Œé‡æ–°ç‚¹å…¥è®¾ç½®å¥½çš„ <code>application</code>, è·å–è´¦å·å¯†é’¥ï¼ˆä¸è¦è·Ÿä»»ä½•äººåˆ†äº« â—ï¼‰</p>
<p>åœ¨Botè´¦å·å¯¹åº”çš„ä»£ç æ–‡ä»¶å¤¹æ‰“å¼€ cmd </p>
<ul>
<li>è¾“å…¥ <code>npm init</code> ï¼Œæ ¹æ®ç›¸å…³æŒ‡å¼•å®Œæˆåˆæ­¥è®¾ç½®</li>
</ul>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Press C at any time to quit.</span><br><span class="line">package name: (mastodon<span class="literal">-human-bot</span>)</span><br><span class="line">version: (<span class="number">1.0</span>.<span class="number">0</span>)</span><br><span class="line">description: building bot</span><br><span class="line">entry point: (index.js) bot.js</span><br><span class="line">test command:</span><br><span class="line">git repository:</span><br><span class="line">keywords: bot, mastodon</span><br><span class="line">author: Erostrate <span class="comment">#è¿™é‡Œæ˜¯æˆ‘çš„åå­—</span></span><br><span class="line">license: (ISC) MIT</span><br><span class="line">About to <span class="built_in">write</span> to D:\mastodon<span class="literal">-human-bot</span>\package.json: </span><br></pre></td></tr></table></figure>

<ul>
<li>è¾“å…¥ <code>code</code> ï¼Œæ‰“å¼€ VS Code ç•Œé¢ï¼Œå¯ä»¥å‘ç°æ–‡ä»¶å¤¹é‡Œå¤šä¸€ä¸ªåä¸º <code>package.json</code> çš„æ–‡ä»¶</li>
<li>åœ¨ <code>package.json</code> åŒçº§ç›®å½•ä¸‹ï¼Œæ–°å»º <code>bot.js</code></li>
</ul>
<h4 id="First-toot"><a href="#First-toot" class="headerlink" title="First toot"></a>First toot</h4><p>åœ¨ <code>bot.js</code> ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆè¦åšçš„æ˜¯è¿æ¥åˆ° Mastodon çš„ç«¯å£ã€‚æˆ‘ä»¬ä½¿ç”¨çš„æ˜¯ <a target="_blank" rel="noopener" href="https://github.com/vanita5/mastodon-api">mastodon-api</a>.<br>å®‰è£…  <a target="_blank" rel="noopener" href="https://github.com/vanita5/mastodon-api">mastodon-api</a></p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install <span class="literal">--save</span> mastodon<span class="literal">-api</span></span><br></pre></td></tr></table></figure>

<p><code>bot.js</code> ä¸­çš„ä»£ç å‚è€ƒï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">Mastodon</span> = <span class="built_in">require</span>(<span class="string">&#x27;mastodon-api&#x27;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Mastodon Bot starting...&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Mastodon</span> <span class="keyword">from</span> <span class="string">&#x27;mastodon-api&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> M = <span class="keyword">new</span> <span class="title class_">Mastodon</span>(&#123;</span><br><span class="line">  <span class="attr">client_key</span>: <span class="string">&#x27;...&#x27;</span>,</span><br><span class="line">  <span class="attr">client_secret</span>: <span class="string">&#x27;...&#x27;</span>,</span><br><span class="line">  <span class="attr">access_token</span>: <span class="string">&#x27;...&#x27;</span>,</span><br><span class="line">  <span class="attr">timeout_ms</span>: <span class="number">60</span> * <span class="number">1000</span>,  <span class="comment">// optional HTTP request timeout to apply to all requests.</span></span><br><span class="line">  <span class="attr">api_url</span>: <span class="string">&#x27;https://botsin.space//api/v1/&#x27;</span>, <span class="comment">// optional, defaults to https://mastodon.social/api/v1/</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>There are three core ways to engage with the Mastodon API</p>
<ul>
<li><code>get</code></li>
<li><code>post</code></li>
<li><code>streaming</code></li>
</ul>
</blockquote>
<p>è¿™é‡Œä¸»è¦ä¼šç”¨åˆ° <code>post</code>ï¼Œå› æ­¤æˆ‘ä»¬æŸ¥çœ‹å®ƒçš„ <a target="_blank" rel="noopener" href="https://github.com/McKael/mastodon-documentation/blob/master/Using-the-API/API.md">è¯´æ˜</a> </p>
<ul>
<li>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°åœ¨ <code>post</code> ä¸­ï¼Œæˆ‘ä»¬çš„ä»£ç æ ¼å¼æ˜¯ <code>M.post(path, [params], callback)</code> </li>
<li>åœ¨ <code>[params]</code> å¤„ï¼Œæ ¹æ®è¯´æ˜ï¼Œå¯ä»¥æœ‰ <code>status</code> ç­‰å¤šé¡¹å…ƒç´ </li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Mastodon Bot starting...&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Mastodon</span> <span class="keyword">from</span> <span class="string">&#x27;mastodon-api&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> M = <span class="keyword">new</span> <span class="title class_">Mastodon</span>(&#123;</span><br><span class="line">  <span class="attr">client_key</span>: <span class="string">&#x27;...&#x27;</span>,</span><br><span class="line">  <span class="attr">client_secret</span>: <span class="string">&#x27;...&#x27;</span>,</span><br><span class="line">  <span class="attr">access_token</span>: <span class="string">&#x27;...&#x27;</span>,</span><br><span class="line">  <span class="attr">timeout_ms</span>: <span class="number">60</span> * <span class="number">1000</span>,  </span><br><span class="line">  <span class="comment">// optional HTTP request timeout to apply to all requests.</span></span><br><span class="line">  <span class="attr">api_url</span>: <span class="string">&#x27;https://wxw.ooo//api/v1/&#x27;</span>, </span><br><span class="line">  <span class="comment">// optional, defaults to https://mastodon.social/api/v1/</span></span><br><span class="line">  <span class="comment">// æ¨èé€‰æ‹©å…ç¿»å¢™çš„å®ä¾‹æˆ–è€…å®ƒçš„é•œåƒ</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> params = &#123;</span><br><span class="line">    <span class="attr">status</span>: <span class="string">&quot;å”‰ã€‚&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">M.<span class="title function_">post</span>(<span class="string">&quot;statuses&quot;</span>, params, <span class="function">(<span class="params">error, data</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (error) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">error</span>(error);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(data);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>å®Œæˆä¸Šè¿°ä»£ç ï¼Œåœ¨ç»ˆç«¯è¿è¡Œ <code>node bot.js</code>ï¼Œä¾¿å¯çœ‹åˆ°æœºå™¨äººå‘è¡¨äº†ç¬¬ä¸€æ¡å˜Ÿæ–‡ã€‚</p>
<h3 id="ğŸ”—-Environment-Variables-in-Node-with-dotenv"><a href="#ğŸ”—-Environment-Variables-in-Node-with-dotenv" class="headerlink" title="ğŸ”— Environment Variables in Node with dotenv"></a><a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=pY4b18JGCKE&list=PLRqwX-V7Uu6byiVX7_Z1rclitVhMBmNFQ&index=3">ğŸ”—</a> Environment Variables in Node with dotenv</h3><h4 id="dotenv"><a href="#dotenv" class="headerlink" title="dotenv"></a><code>dotenv</code></h4><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install dotenv</span><br></pre></td></tr></table></figure>

<p><code>dotenv</code> å¯ä»¥å¸®åŠ©æˆ‘ä»¬ä¸ºä¸€ä¸ªé¡¹ç›®åˆ›å»ºç¯å¢ƒå˜é‡ã€‚åœ¨è¿™é‡Œå¯ä»¥ç”¨äºéšè—å¯†é’¥ã€‚</p>
<p>å¦‚æœè¿è¡Œ<code>node bot.js</code> æŠ¥é”™ <code>SyntaxError: Cannot use import statement outside a module</code>ï¼Œè§£å†³æ–¹æ³•è§<a href="ai_bot_errors.html">ä¿®ç†æ—¥è®°</a>ã€‚</p>
<p>æ–°å»º <code>.env</code> æ–‡ä»¶ï¼Œåœ¨å…¶ä¸­è¾“å…¥ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">AUTH_TOKEN = ...</span><br><span class="line">CLIENT_SECRET = ...</span><br><span class="line">CLIENT_KEY = ...</span><br></pre></td></tr></table></figure>

<h4 id="bot-js-1"><a href="#bot-js-1" class="headerlink" title="bot.js"></a><code>bot.js</code></h4><p>æ‰“å¼€ <code>bot.js</code> ï¼Œä¿®æ”¹å¦‚ä¸‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Mastodon Bot starting...&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="variable constant_">ENV</span> <span class="keyword">from</span> <span class="string">&quot;dotenv&quot;</span> <span class="comment">//åŠ è½½dotenv</span></span><br><span class="line"><span class="variable constant_">ENV</span>.<span class="title function_">config</span>()</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Mastodon</span> <span class="keyword">from</span> <span class="string">&#x27;mastodon-api&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> M = <span class="keyword">new</span> <span class="title class_">Mastodon</span>(&#123;</span><br><span class="line">  <span class="attr">client_key</span>: process.<span class="property">env</span>.<span class="property">CLIENT_KEY</span>, <span class="comment">//ä½¿ç”¨.envä¸­çš„ä¿¡æ¯ï¼Œéšå»ä¸Šä¸€ä¸ªä»£ç å—ä¸­çš„ç›¸å…³ä¿¡æ¯</span></span><br><span class="line">  <span class="attr">client_secret</span>: process.<span class="property">env</span>.<span class="property">CLIENT_SECRET</span>,</span><br><span class="line">  <span class="attr">access_token</span>: process.<span class="property">env</span>.<span class="property">AUTH_TOKEN</span>,</span><br><span class="line">  <span class="attr">timeout_ms</span>: <span class="number">60</span> * <span class="number">1000</span>,  <span class="comment">// optional HTTP request timeout to apply to all requests.</span></span><br><span class="line">  <span class="attr">api_url</span>: <span class="string">&#x27;https://botsin.space//api/v1/&#x27;</span>, <span class="comment">// optional, defaults to https://mastodon.social/api/v1/</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> params = &#123;</span><br><span class="line">    <span class="attr">status</span>: <span class="string">&quot;å”‰ã€‚&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">M.<span class="title function_">post</span>(<span class="string">&quot;statuses&quot;</span>, params, <span class="function">(<span class="params">error, data</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (error) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">error</span>(error);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(data);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h4 id="gitignore"><a href="#gitignore" class="headerlink" title=".gitignore"></a><code>.gitignore</code></h4><p>ä¸æ­¤åŒæ—¶ï¼Œæ–°å»º <code>.gitignore</code> æ–‡ä»¶ï¼Œåœ¨å…¶ä¸­é”®å…¥ <code>.env</code>ã€‚è¿™æ ·åšçš„ç›®çš„æ˜¯ï¼Œåç»­Git ä¸Šä¼ ä»£ç çš„æ—¶å€™ï¼Œä¸ä¼šå°†å¯†é’¥æš´éœ²ã€‚</p>
<h3 id="ğŸ”—-Posting-with-setInterval"><a href="#ğŸ”—-Posting-with-setInterval" class="headerlink" title="ğŸ”— Posting with setInterval()"></a><a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=pY4b18JGCKE&list=PLRqwX-V7Uu6byiVX7_Z1rclitVhMBmNFQ&index=4">ğŸ”—</a> Posting with setInterval()</h3><p><code>setInterval()</code> è¿™ä¸ªå‡½æ•°ï¼Œé¡¾åæ€ä¹‰ï¼Œå°±æ˜¯è®©ä½ çš„ Bot å®šæ—¶åšä¸€äº›äº‹ã€‚</p>
<h4 id="bot-js-2"><a href="#bot-js-2" class="headerlink" title="bot.js"></a><code>bot.js</code></h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> fs <span class="keyword">from</span> <span class="string">&quot;fs&quot;</span></span><br><span class="line"></span><br><span class="line">M.<span class="title function_">post</span>(<span class="string">&quot;statuses&quot;</span>, params, <span class="function">(<span class="params">error, data</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (error) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">error</span>(error);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        fs.<span class="title function_">writeFileSync</span>(<span class="string">&#x27;data.json&#x27;</span>, <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(data, <span class="literal">null</span>, <span class="number">2</span>); <span class="comment">// åŠ ä¸Šè¿™ä¸€è¡Œ</span></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(data);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>è¿è¡Œå®Œæ¯•åï¼ŒåŒçº§ç›®å½•ä¸‹ä¼šå¤šå‡º <code>data.json</code> æ–‡ä»¶ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">M.<span class="title function_">post</span>(<span class="string">&quot;statuses&quot;</span>, params, <span class="function">(<span class="params">error, data</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (error) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">error</span>(error);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;ID: &#x27;</span> + data.<span class="property">id</span> + <span class="string">&#x27; and timestamp: &#x27;</span> + data.<span class="property">created_at</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸€æ­¥çš„æ›´æ”¹ï¼Œä½¿å¾—æ¯æ¬¡æˆåŠŸå‘è¡¨å˜Ÿæ–‡ä¹‹åï¼Œæ§åˆ¶å°è¿”å›å‘è¡¨å˜Ÿæ–‡çš„ <code>id</code> å’Œ <code>created_at</code> ä¿¡æ¯ã€‚å¦‚æœæƒ³è¿”å›å…¶ä»–ä¿¡æ¯å¯æŸ¥è¯¢ <code>data.json</code> æ–‡ä»¶ä¸­ï¼Œæ¯æ¡å˜Ÿæ–‡ä¼šæœ‰çš„ä¿¡æ¯ç±»å‹ã€‚</p>
<h4 id="status"><a href="#status" class="headerlink" title="status:"></a><code>status:</code></h4><p>æ›´æ”¹ä¸‹é¢ä»£ç çš„ <code>status</code>ï¼Œå¯ä»¥æ”¹å˜æ¯æ¬¡å˜Ÿæ–‡çš„å†…å®¹ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> params = &#123;</span><br><span class="line">    <span class="attr">status</span>: <span class="string">&quot;å”‰ã€‚&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="setInterval-function-interval-in-millisec"><a href="#setInterval-function-interval-in-millisec" class="headerlink" title="setInterval(function, interval_in_millisec)"></a><code>setInterval(function, interval_in_millisec)</code></h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">toot_make_love</span>();</span><br><span class="line">	<span class="comment">//Defining a function to toot</span></span><br><span class="line"><span class="built_in">setInterval</span>(toot_make_love, <span class="number">24</span> * <span class="number">60</span> * <span class="number">60</span> * <span class="number">1000</span>); </span><br><span class="line">    <span class="comment">//millisec = sec * 1000</span></span><br><span class="line">    <span class="comment">//It means &quot;do the function every 60 seconds&quot;.</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">toot_make_love</span>(<span class="params"></span>)&#123;</span><br><span class="line"><span class="keyword">const</span> num = <span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>() * <span class="number">10</span>); </span><br><span class="line">    <span class="comment">//Returning a float between 0 and 1</span></span><br><span class="line"><span class="keyword">const</span> params = &#123;</span><br><span class="line">    <span class="attr">spoiler_text</span>: <span class="string">&quot;âš  NSFW&quot;</span>,</span><br><span class="line">    <span class="attr">status</span>: <span class="string">&quot;å”‰ï¼Œä½ cpä»Šå¤©åšäº† &quot;</span> + num + <span class="string">&quot; æ¬¡çˆ±ã€‚&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">	<span class="comment">//Defining the content of the toot</span></span><br><span class="line"></span><br><span class="line">M.<span class="title function_">post</span>(<span class="string">&quot;statuses&quot;</span>, params, <span class="function">(<span class="params">error, data</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (error) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">error</span>(error);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;ID: &#x27;</span> + data.<span class="property">id</span> + <span class="string">&#x27; and timestamp: &#x27;</span> + data.<span class="property">created_at</span>);</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(data.<span class="property">content</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="ğŸ”—-Streaming-API"><a href="#ğŸ”—-Streaming-API" class="headerlink" title="ğŸ”— Streaming API"></a><a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=pY4b18JGCKE&list=PLRqwX-V7Uu6byiVX7_Z1rclitVhMBmNFQ&index=5">ğŸ”—</a> Streaming API</h3><p><code>streaming</code> å¯ä»¥å¸®åŠ©æˆ‘ä»¬å®æ—¶è·å–ç”¨æˆ·æ´»åŠ¨ï¼ˆç±»ä¼¼äº <code>notification</code>ï¼‰</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> listener = M.<span class="title function_">stream</span>(<span class="string">&#x27;streaming/user&#x27;</span>)</span><br><span class="line"></span><br><span class="line">listener.<span class="title function_">on</span>(<span class="string">&#x27;message&#x27;</span>, <span class="function"><span class="params">msg</span> =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(msg))</span><br><span class="line">listener.<span class="title function_">on</span>(<span class="string">&#x27;error&#x27;</span>, <span class="function"><span class="params">err</span> =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(err))</span><br></pre></td></tr></table></figure>

<p>ç›¸å…³é—®é¢˜è§<a href="ai_bot_errors.html">ä¿®ç†æ—¥è®°</a>ã€‚</p>
<h3 id="ğŸ”—-Managing-User-Eventsï¼ˆå¾…ç»­ï¼‰"><a href="#ğŸ”—-Managing-User-Eventsï¼ˆå¾…ç»­ï¼‰" class="headerlink" title="ğŸ”— Managing User Eventsï¼ˆå¾…ç»­ï¼‰"></a><a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=pY4b18JGCKE&list=PLRqwX-V7Uu6byiVX7_Z1rclitVhMBmNFQ&index=6">ğŸ”—</a> Managing User Eventsï¼ˆå¾…ç»­ï¼‰</h3><h3 id="ğŸ”—-Replying-to-a-Mentionï¼ˆå¾…ç»­ï¼‰"><a href="#ğŸ”—-Replying-to-a-Mentionï¼ˆå¾…ç»­ï¼‰" class="headerlink" title="ğŸ”— Replying to a Mentionï¼ˆå¾…ç»­ï¼‰"></a><a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=pY4b18JGCKE&list=PLRqwX-V7Uu6byiVX7_Z1rclitVhMBmNFQ&index=7">ğŸ”—</a> Replying to a Mentionï¼ˆå¾…ç»­ï¼‰</h3><h3 id="ğŸ”—-Tree-Bot"><a href="#ğŸ”—-Tree-Bot" class="headerlink" title="ğŸ”— Tree Bot"></a><a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=pY4b18JGCKE&list=PLRqwX-V7Uu6byiVX7_Z1rclitVhMBmNFQ&index=11">ğŸ”—</a> Tree Bot</h3><p>å¦‚æœæˆ‘ä»¬éœ€è¦ä¸€ä¸ªåŠŸèƒ½ä¸ºå®šæ—¶äº§ç”Ÿã€å‘é€éšæœºè¯­å¥çš„botï¼Œæˆ‘ä»¬éœ€è¦åšçš„äº‹æƒ…æœ‰ï¼š</p>
<ul>
<li>è®¾ç½®å¥½è¿è¡Œç›¸åº”åŠŸèƒ½çš„ä»£ç </li>
<li>åœ¨ <code>bot.js</code> ä¸­è¿›è¡Œå®šæ—¶ã€ä¸Šä¼ ã€å‘å˜Ÿ</li>
</ul>
<p>åˆ°è¿™ä¸€æ­¥ï¼Œä½ å¯èƒ½ä¼šä¸æ–­åœ°é‡åˆ° <code>443</code> é”™è¯¯ï¼Œè¿™é‡Œæˆ‘æä¾›äº†æˆ‘çš„<a href="ai_bot_errors.html">ä¿®ç†æ—¥è®°</a>ã€‚å¦‚æœä½ é‡åˆ°äº†ï¼Œä¸è¦æ°”é¦ï¼ŒåšæŒåšä¸‹å»æ€»ä¼šæœ‰ç»“æœçš„ï¼</p>
<h4 id="å®šæ—¶å‘é€"><a href="#å®šæ—¶å‘é€" class="headerlink" title="å®šæ—¶å‘é€"></a>å®šæ—¶å‘é€</h4><p>è¿™ä¸ªåŠŸèƒ½åœ¨ <code>bot.js</code> ä¸­çš„å®ç°éµå¾ªä»¥ä¸‹æ€è·¯ï¼š</p>
<ul>
<li>è¿æ¥è´¦å·</li>
<li>æ‰§è¡ŒåŠŸèƒ½<ul>
<li>è·å–ç›¸åº”åŠŸèƒ½çš„ .py</li>
<li>é€šè¿‡ <code>setInterval()</code>  è®¾ç½®æ—¶é—´é—´éš”</li>
<li>ä¸Šä¼  .py çš„è¾“å‡ºç»“æœ</li>
<li>å‘é€å˜Ÿå˜Ÿ</li>
</ul>
</li>
</ul>
<p>æˆ‘ä»¬å€ŸåŠ© <code>child_process</code> æ¨¡å—ä¸­çš„ <code>exec</code> æ¥è¿æ¥æ‰§è¡ŒåŠŸèƒ½çš„ .py æ–‡ä»¶ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; exec &#125; <span class="keyword">from</span> <span class="string">&#x27;child_process&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> exec_promisify = util.<span class="title function_">promisify</span>(exec);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">function</span> = <span class="string">&#x27;python ./function.py&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸€æ­¥ï¼Œæˆ‘ä»¬çš„éœ€æ±‚æ˜¯â€œé€šè¿‡ <code>bot.js</code> åœ¨ç»ˆç«¯è·å– <code>function.py</code> çš„è¾“å‡ºç»“æœâ€ï¼Œå› æ­¤æˆ‘ä»¬æ¥ç€ï¼š </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Â  Â  <span class="keyword">const</span> response = <span class="title function_">exec_promisify</span>(<span class="keyword">function</span>);</span><br><span class="line"><span class="comment">// åœ¨ç»ˆç«¯æ‰§è¡Œ `function`</span></span><br><span class="line">Â  Â  <span class="variable language_">console</span>.<span class="title function_">log</span>(response.<span class="property">stdout</span>);</span><br><span class="line">Â  Â  <span class="comment">// åœ¨ç»ˆç«¯å‘ˆç°è¾“å‡ºç»“æœ</span></span><br></pre></td></tr></table></figure>

<p>è¾“å‡ºç»“æœå¦‚æœæ˜¯ä¸­æ–‡è¯­å¥ï¼Œå¯èƒ½ä¼šå‡ºç°ä¹±ç æƒ…å†µï¼Œè§£å†³æ–¹æ³•è§<a href="ai_bot_errors.html">ä¿®ç†æ—¥è®°</a>ã€‚</p>
<p>åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬åŸºæœ¬ä¸Šå·²ç»å®Œæˆäº†æœºå™¨äººéœ€è¦çš„éƒ¨åˆ†ï¼Œå‰©ä¸‹è¦åšçš„å°±æ˜¯æŠŠå†…å®¹æ•´ç†åœ¨ä¸€èµ·ã€‚æˆ‘ä»¬å¯ä»¥æŠŠéœ€è¦æ‰§è¡Œçš„åŠŸèƒ½è§†ä¸ºä¸€ä¸ªå‡½æ•°ï¼ˆfunctionï¼‰ï¼Œ<strong>æœºå™¨äººåšçš„å°±æ˜¯ä¸æ–­åœ°ï¼Œåœ¨ä¸€å®šæ¡ä»¶ä¸‹ï¼Œè¿è¡Œè¿™ä¸ªå‡½æ•°ï¼ŒåŒæ—¶æŠŠå‡½æ•°ç»“æœè¾“å‡ºåœ¨æ—¶é—´è½´ä¸Š</strong>ã€‚å› æ­¤ï¼Œæˆ‘ä»¬é¦–å…ˆè¦åšçš„æ˜¯æŠŠåŠŸèƒ½å°è£…åˆ°ä¸€ä¸ªå‡½æ•°ä¸‹ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">	<span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">toot_sigh</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">const</span> response = <span class="keyword">await</span> <span class="title function_">exec_promisify</span>(sigh);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(response.<span class="property">stdout</span>);</span><br><span class="line">    <span class="comment">// Step 1: Exec processing (create a output string)</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">const</span> params = &#123;</span><br><span class="line">        <span class="attr">status</span>: response.<span class="property">stdout</span>,</span><br><span class="line">        <span class="attr">visibility</span>: <span class="string">&#x27;unlisted&#x27;</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="comment">// Step 2: Upload (return and attach to the following toot)</span></span><br><span class="line">    <span class="comment">// ç”±äºè¿™é‡Œæˆ‘åªéœ€è¦å­—ç¬¦ä¸²ï¼Œå› æ­¤ç›¸æ¯”ä¸Šä¼ å›¾ç‰‡ä¼šæ›´åŠ ç®€å•ã€‚éœ€è¦ä¸Šä¼ å›¾ç‰‡å¯å‚ç…§è§†é¢‘ä»£ç ã€‚</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> final_response = <span class="keyword">await</span> M.<span class="title function_">post</span>(<span class="string">&#x27;statuses&#x27;</span>, params); </span><br><span class="line">    <span class="comment">// Step 3: Toot!</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="attr">success</span>: <span class="literal">true</span></span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿˜è®°å¾—æˆ‘ä»¬ä¹‹å‰çš„ <code>setInterval()</code> å—ï¼Ÿå—¯ï¼Œå¥—ä¸Šå»ã€‚æˆ‘ä»¬åœ¨ä¸Šä¸€ä¸ªä»£ç ä¸²çš„å‰é¢åŠ ä¸Šä»¥ä¸‹ä»£ç ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> sigh = <span class="string">&#x27;python ./sigh.py&#x27;</span>;</span><br><span class="line"><span class="comment">// è·å–ç›¸åº”åŠŸèƒ½çš„ .py</span></span><br><span class="line"></span><br><span class="line"><span class="title function_">toot_sigh</span>()</span><br><span class="line">    .<span class="title function_">then</span>(<span class="function"><span class="params">response</span> =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(response))</span><br><span class="line">    .<span class="title function_">catch</span>(<span class="function"><span class="params">error</span> =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">error</span>(error));</span><br><span class="line"><span class="comment">// å®šæ—¶å¼€å§‹ä¹‹å‰å…ˆè¿è¡Œä¸€æ¬¡</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">setInterval</span>(</span><br><span class="line">    <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="title function_">toot_sigh</span>()</span><br><span class="line">            .<span class="title function_">then</span>(<span class="function"><span class="params">response</span> =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(response))</span><br><span class="line">            .<span class="title function_">catch</span>(<span class="function"><span class="params">error</span> =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">error</span>(error));</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">//10 * 1000</span></span><br><span class="line">    <span class="number">3</span> * <span class="number">60</span> * <span class="number">60</span> * <span class="number">1000</span></span><br><span class="line">    <span class="comment">// millisec = sec * 1000</span></span><br><span class="line">); </span><br><span class="line"><span class="comment">// è®¾ç½®å®šæ—¶</span></span><br></pre></td></tr></table></figure>

<p>è¿™æ—¶ï¼Œä¿å­˜ï¼Œè¿è¡Œ <code>node bot.js</code> ï¼Œç†è®ºä¸Šæˆ‘ä»¬çš„æœºå™¨äººå°±å¼€å§‹å˜Ÿå˜Ÿå˜Ÿå˜Ÿå˜Ÿäº†ã€‚å¦‚æœåˆé‡åˆ°äº† <code>443</code> é”™è¯¯ï¼Œè¯·å‚ç…§<a href="ai_bot_errors.html">ä¿®ç†æ—¥è®°</a>è§£å†³ã€‚</p>
<p>æœ€åï¼Œå¦‚æœæœºå™¨äººåç»­è¿˜ä¼šæœ‰åˆ«çš„åŠŸèƒ½ï¼Œæ¯ä¸ªåŠŸèƒ½çš„ä»£ç ä¹Ÿæ˜¯ç±»ä¼¼çš„ç¼–å†™æ¨¡å¼ã€‚å…·ä½“æ¡ˆä¾‹å¯ä»¥å‚ç…§ <a target="_blank" rel="noopener" href="https://github.com/TheTarr/mastodon_bot">æ“æ“</a> çš„ <code>bot.js</code>.</p>
<h4 id="å³æ—¶åº”ç­”ï¼ˆå¾…ç»­ï¼‰"><a href="#å³æ—¶åº”ç­”ï¼ˆå¾…ç»­ï¼‰" class="headerlink" title="å³æ—¶åº”ç­”ï¼ˆå¾…ç»­ï¼‰"></a>å³æ—¶åº”ç­”ï¼ˆå¾…ç»­ï¼‰</h4><p>è¿™éƒ¨åˆ†æˆ‘ä»¬è¦ç”¨åˆ°çš„æ˜¯ mastodon-api çš„ <code>stream</code> åŠŸèƒ½ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M.<span class="title function_">stream</span>(path, [params])</span><br></pre></td></tr></table></figure>

<h4 id="æœåŠ¡å™¨éƒ¨ç½²"><a href="#æœåŠ¡å™¨éƒ¨ç½²" class="headerlink" title="æœåŠ¡å™¨éƒ¨ç½²"></a>æœåŠ¡å™¨éƒ¨ç½²</h4><p>å»ºè®®åœ¨å¼€å§‹ä¹‹å‰ï¼Œå…ˆå‚ç…§<a target="_blank" rel="noopener" href="https://derek.coderbridge.io/2020/10/20/%E9%83%A8%E7%BD%B2-nodejs-app-%E5%9C%A8-heroku/">è¿™ç¯‡æ–‡ç« </a>æŠŠç›¸åº”çš„ä»£ç é…ç½®å¥½ï¼Œä»¥å…åç»­åƒæˆ‘ä¸€æ ·åŠ³å¿ƒä¼¤ç¥ã€‚</p>
<p>è¿™ä¸€æ­¥ï¼Œè¯·æ£€æŸ¥å¥½ï¼š</p>
<ul>
<li><code>Procfile</code> æ–‡ä»¶è®¾ç½®å¥½äº†æ²¡æœ‰ï¼ˆæ— æ‹“å±•åï¼Œå†…å®¹å¦‚å‚è€ƒæ–‡ç« æ‰€ç¤ºï¼‰</li>
<li><code>package.json</code> çš„ <code>&quot;start&quot;</code> è®¾ç½®å¥½äº†æ²¡æœ‰ï¼ˆå¦‚æœå¼€å¯botçš„ä»£ç ä¸º<code>node bot.js</code>ï¼Œåˆ™å†…å®¹åº”ä¸º<code>node bot.js</code>ï¼‰</li>
<li>åœ¨æœ¬åœ°çš„ç»ˆç«¯æ§åˆ¶å°é”®å…¥<code>npm start</code>ï¼Œä»£ç åº”è¯¥èƒ½å¦‚å¸¸è¿è¡Œ</li>
</ul>
<p>æˆ‘ä½¿ç”¨äº† <a target="_blank" rel="noopener" href="https://www.heroku.com/">heroku</a> è¿›è¡Œéƒ¨ç½²ï¼Œå®˜æ–¹æ•™ç¨‹è§<a target="_blank" rel="noopener" href="https://devcenter.heroku.com/articles/getting-started-with-nodejs#set-up">æ­¤å¤„</a>ï¼Œä¹Ÿå¯ä»¥å‚ç…§ <a target="_blank" rel="noopener" href="https://www.jianshu.com/p/19b7c919907a">è¿™ç¯‡</a>ã€‚</p>
<p>ç¬¬ä¸€æ­¥éœ€è¦<strong>åœ¨å¯¹åº”çš„ git ä»“åº“è®¾ç½®å¥½ heroku çš„è¿œç¨‹ç«¯å£</strong>ï¼Œè¿™ä¸€æ­¥éœ€è¦ä»£ç†ã€‚æˆ‘è¿™è¾¹ç”¨çš„æ˜¯ Clashï¼Œåœ¨ Clash é¦–é¡µç¬¬ä¸€é¡¹ <code>Port</code> å¯ä»¥ç›´æ¥ç‚¹å‡»å³ä¾§å›¾æ ‡ï¼Œè¿›å…¥å·²ç»è®¾ç½®å¥½ä»£ç†çš„ powershellã€‚é”®å…¥ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">heroku login</span><br></pre></td></tr></table></figure>

<p>å› ä¸ºæˆ‘è¿™è¾¹æœ¬åœ°å·²ç»æœ‰ä»“åº“ï¼Œæ‰€ä»¥ç›´æ¥åœ¨cmdæ‰“å¼€æœ¬åœ°ä»“åº“ï¼ŒåŒæ—¶å‚è€ƒ<a target="_blank" rel="noopener" href="https://devcenter.heroku.com/articles/git#create-a-heroku-remote">è¿™ä»½æ•™ç¨‹</a>è¿›è¡Œéƒ¨ç½²ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">heroku create -a your-app-name</span><br><span class="line"># è¿™ä¸€æ­¥æ˜¯åˆ›å»ºä¸€ä¸ªæ–°çš„app</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">heroku git:remote -a your-existed-app-name</span><br><span class="line"># è¿™ä¸€æ­¥æ˜¯åœ¨ä½ å·²ç»æœ‰çš„æœ¬åœ°ä»“åº“ä¸Šï¼Œæ·»åŠ ä¸€ä¸ªherokuçš„è¿œç¨‹</span><br><span class="line"># è¿™ä¸€æ­¥ä¸ä»¥ä¸Šé‚£ä¸€æ­¥äºŒé€‰ä¸€</span><br></pre></td></tr></table></figure>

<p>å®Œæˆä¹‹åï¼Œæ‰“å¼€ heroku çš„ dashboardï¼Œåº”è¯¥èƒ½çœ‹åˆ°å¯¹åº” app çš„ <code>deploy</code> æ å·²ç»æ˜¾ç¤ºäº†ç›¸åº”çš„ git ä»“åº“ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git remote rename heroku heroku-your-name</span><br><span class="line"># ä¸ºherokuçš„è¿œç¨‹å‘½å</span><br></pre></td></tr></table></figure>

<p>heroku çš„è¿œç¨‹é»˜è®¤ä¸åŸä»“åº“åŒåï¼Œä¸ºäº†ä¾¿äºåŒºåˆ†ï¼Œè¿™é‡Œæ¨èè¿›è¡Œé‡å‘½åã€‚ä¸‹ä¸€æ­¥æˆ‘ä»¬å°†ä»£ç éƒ¨ç½²åˆ° heroku çš„è¿œç¨‹ä¸Šã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git push heroku-your-name main</span><br></pre></td></tr></table></figure>

<p> main å‰ä¸ºè¿œç¨‹ä¸»æœºåï¼Œå¦‚æœåˆ†æ”¯æ˜¯<code>master</code>ï¼Œé‚£ä¹ˆæŠŠ<code>main</code>æ”¹ä¸º<code>masterå³å¯</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git push heroku-your-name testbranch:main</span><br></pre></td></tr></table></figure>

<blockquote>
<p>To deploy code to Heroku from a non-main branch of your local repository (for example, <code>testbranch</code>), use the following syntax push it to the remoteâ€™s <code>main</code> branch.</p>
</blockquote>
<p>è¿™ä¸€æ­¥çš„è§£é‡Šå¯ä»¥ç±»æ¯”<a target="_blank" rel="noopener" href="https://www.runoob.com/git/git-push.html">è¿™é‡Œ</a>ï¼Œå¤§æ¦‚çš„æ„æ€å°±æ˜¯ï¼Œå¦‚æœä¸æ˜¯ <code>main</code> æˆ–è€… <code>master</code> åˆ†æ”¯ï¼Œé‚£ä¹ˆå°±å°†ç›¸åº”åˆ†æ”¯æ¨åˆ° <code>main</code> åˆ†æ”¯ï¼Œå†è¿›è¡Œä¸Šä¼ ã€‚</p>
<p>å¦‚æœä½ åƒæˆ‘ä¸€æ ·ä¹‹å‰ä¹±æï¼Œé‚£ä¹ˆåœ¨è¿™ä¸€æ­¥å¯èƒ½ä¼šæŠ¥é”™è¯´ <code>Error: Multiple apps in git remotes</code>ï¼Œè§£å†³æ–¹æ³•è§ <a href="./ai_bot_errors">ä¿®ç†æ—¥è®°</a>ã€‚</p>
<p>å®Œæˆä¹‹åä¾æ¬¡è¾“å…¥è¿™ä¸¤è¡Œä»£ç ï¼Œæµ‹è¯•èƒ½å¦æ­£å¸¸è¿è¡Œã€‚èƒ½æ­£å¸¸è¿è¡Œåˆ™è¯´æ˜ï¼Œæˆ‘ä»¬çš„ä»£ç åœ¨æœ¬åœ°è¿è¡Œå·²ç»æ²¡æœ‰é—®é¢˜äº†ï¼ˆå°½ç®¡æš‚æ—¶è¿˜ä¸èƒ½ç›´æ¥åœ¨æœåŠ¡å™¨è¿è¡Œï¼‰ï¼ŒåŒæ—¶ï¼Œæˆ‘ä»¬å·²ç»æˆåŠŸäº†ä¸€å¤§åŠï¼</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">heroku ps:scale web=1</span><br><span class="line">heroku local web</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œæˆ‘å‡ºç°äº† <code>Incorrect Port Setup</code> å’Œ <code>AppCrashed</code> é”™è¯¯ï¼Œè§£å†³æ–¹æ³•è§ <a href="./ai_bot_errors">ä¿®ç†æ—¥è®°</a>ã€‚</p>
<p><a target="_blank" rel="noopener" href="https://devcenter.heroku.com/articles/getting-started-with-nodejs#push-local-changes">https://devcenter.heroku.com/articles/getting-started-with-nodejs#push-local-changes</a></p>
	  
	</div>

	<div>
  	<center>
	<div class="pagination">

    
    
    <a href="/posts/men_in_dark_times_0.html" type="button" class="btn btn-default"><i
                class="fa fa-arrow-circle-o-left"></i> Prev</a>
    

    <a href="/" type="button" class="btn btn-default"><i class="fa fa-home"></i>Home</a>
    
    <a href="/posts/ai_bot_errors.html" type="button" class="btn btn-default ">Next<i
                class="fa fa-arrow-circle-o-right"></i></a>
    

    
</div>

    </center>
	</div>
	
	<!-- comment -->
	
<section id="comment">

    
</section>


	</div> <!-- col-md-9/col-md-12 -->
		
	
	<div id="side_meta">
		<div class="col-md-3" id="post_meta"> 

	<!-- date -->
	
	<div class="meta-widget">
	<i class="fa fa-clock-o"></i>
	2022-10-23 
	</div>
	

	<!-- categories -->
    
	<div class="meta-widget">
	<a data-toggle="collapse" data-target="#categorys"><i class="fa fa-folder"></i></a>	
    <ul id="categorys" class="tag_box list-unstyled collapse in">
          
  <li>
    <li><a href="/categories/ç¬”è®°/">ç¬”è®°<span>8</span></a></li>
  </li>

    </ul>
	</div>
	

	<!-- tags -->
	
	<div class="meta-widget">
	<a data-toggle="collapse" data-target="#tags"><i class="fa fa-tags"></i></a>		  
    <ul id="tags" class="tag_box list-unstyled collapse in">	  
	    
  <li><a href="/tags/Mastodon/">Mastodon<span>4</span></a></li> <li><a href="/tags/Bot/">Bot<span>2</span></a></li> <li><a href="/tags/è…¦æ´/">è…¦æ´<span>2</span></a></li> <li><a href="/tags/å”‰é…±/">å”‰é…±<span>2</span></a></li> <li><a href="/tags/heroku/">heroku<span>2</span></a></li> <li><a href="/tags/node-js/">node.js<span>2</span></a></li> <li><a href="/tags/é€ ç‰©/">é€ ç‰©<span>3</span></a></li>
    </ul>
	</div>
		

	<!-- toc -->
	<div class="meta-widget">
	
	   <a data-toggle="collapse" data-target="#toc"><i class="fa fa-bars"></i></a>
	   <div id="toc" class="toc collapse in">
		   <span class="toc-title">Contents</span>
			<ol class="toc-article"><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-article-text">å‰è¨€</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#%E6%90%AD%E5%BB%BA"><span class="toc-article-text">æ­å»º</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#%F0%9F%94%97-Setting-up-a-Mastodon-Bot"><span class="toc-article-text">ğŸ”— Setting up a Mastodon Bot</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-4"><a class="toc-article-link" href="#bot-js"><span class="toc-article-text">bot.js</span></a></li><li class="toc-article-item toc-article-level-4"><a class="toc-article-link" href="#First-toot"><span class="toc-article-text">First toot</span></a></li></ol></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#%F0%9F%94%97-Environment-Variables-in-Node-with-dotenv"><span class="toc-article-text">ğŸ”— Environment Variables in Node with dotenv</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-4"><a class="toc-article-link" href="#dotenv"><span class="toc-article-text">dotenv</span></a></li><li class="toc-article-item toc-article-level-4"><a class="toc-article-link" href="#bot-js-1"><span class="toc-article-text">bot.js</span></a></li><li class="toc-article-item toc-article-level-4"><a class="toc-article-link" href="#gitignore"><span class="toc-article-text">.gitignore</span></a></li></ol></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#%F0%9F%94%97-Posting-with-setInterval"><span class="toc-article-text">ğŸ”— Posting with setInterval()</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-4"><a class="toc-article-link" href="#bot-js-2"><span class="toc-article-text">bot.js</span></a></li><li class="toc-article-item toc-article-level-4"><a class="toc-article-link" href="#status"><span class="toc-article-text">status:</span></a></li><li class="toc-article-item toc-article-level-4"><a class="toc-article-link" href="#setInterval-function-interval-in-millisec"><span class="toc-article-text">setInterval(function, interval_in_millisec)</span></a></li></ol></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#%F0%9F%94%97-Streaming-API"><span class="toc-article-text">ğŸ”— Streaming API</span></a></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#%F0%9F%94%97-Managing-User-Events%EF%BC%88%E5%BE%85%E7%BB%AD%EF%BC%89"><span class="toc-article-text">ğŸ”— Managing User Eventsï¼ˆå¾…ç»­ï¼‰</span></a></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#%F0%9F%94%97-Replying-to-a-Mention%EF%BC%88%E5%BE%85%E7%BB%AD%EF%BC%89"><span class="toc-article-text">ğŸ”— Replying to a Mentionï¼ˆå¾…ç»­ï¼‰</span></a></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#%F0%9F%94%97-Tree-Bot"><span class="toc-article-text">ğŸ”— Tree Bot</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-4"><a class="toc-article-link" href="#%E5%AE%9A%E6%97%B6%E5%8F%91%E9%80%81"><span class="toc-article-text">å®šæ—¶å‘é€</span></a></li><li class="toc-article-item toc-article-level-4"><a class="toc-article-link" href="#%E5%8D%B3%E6%97%B6%E5%BA%94%E7%AD%94%EF%BC%88%E5%BE%85%E7%BB%AD%EF%BC%89"><span class="toc-article-text">å³æ—¶åº”ç­”ï¼ˆå¾…ç»­ï¼‰</span></a></li><li class="toc-article-item toc-article-level-4"><a class="toc-article-link" href="#%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%83%A8%E7%BD%B2"><span class="toc-article-text">æœåŠ¡å™¨éƒ¨ç½²</span></a></li></ol></li></ol></li></ol>
		</div>
	
	</div>
	
    <hr>
	
</div><!-- col-md-3 -->

	</div>
		

</div><!-- row -->



	</div>
  </div>
  <div class="container-narrow">
  <footer> <p>
  &copy; 2022 Erostrate
  
      <br>
      </a>Theme developed based on <a target="_blank" rel="noopener" href="https://github.com/blackshow/hexo-theme-freemind.386">Freemind.386</a>.    
</p>
 </footer>
</div> <!-- container-narrow -->
  


  
<a id="gotop" href="#">   
  <span>â¬†ï¸TOP</span>
</a>

<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/main.js"></script>
<script src="/js/search.js"></script> 


<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>



   <script type="text/javascript">      
     var search_path = "search.xml";
	 if (search_path.length == 0) {
	 	search_path = "search.xml";
	 }
	 var path = "/" + search_path;
     searchFunc(path, 'local-search-input', 'local-search-result');
   </script>

</body>
   </html>
